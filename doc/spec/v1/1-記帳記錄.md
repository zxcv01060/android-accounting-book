# 記帳記錄

[上一篇 - 系統設計](0-系統設計.md) | [下一篇 - 錢包](2-錢包.md)

> 預計實現版本：v1.0

## 功能介紹

使用者可以在此功能查看當前月份每一天的記帳記錄清單，藉此掌握每一天的收支，同時也是開啟此應用程式時顯示的第一個頁面

目前一共分為收入、支出兩種分類，每個分類的顏色以及可用的類型如下：

* 收入(#FF6870)

    | 類型   | Icon |
    |------|------|
    | 利息   |      |
    | 薪水   |      |
    | 借錢還款 |      |
    | 代收   |      |
    | 代付收款 |      |
    | 其他   |      |

* 支出(#72FF6D)

    | 類型   | Icon |
    |------|------|
    | 早餐   |      |
    | 午餐   |      |
    | 晚餐   |      |
    | 零食   |      |
    | 飲料   |      |
    | 交通   |      |
    | 娛樂   |      |
    | 醫療   |      |
    | 保險   |      |
    | 生活用品 |      |
    | 住宿   |      |
    | 借款   |      |
    | 代付   |      |
    | 代收付款 |      |
    | 其他   |      |

在使用者剛開啟此應用程式時，App會去檢查是否有未新增的週期記帳，若有，則在自動新增後顯示提示訊息："已新增*筆週期記帳"，*號處需帶入這次新增的筆數

## 畫面

### 清單

此處為記帳記錄功能第一個顯示的畫面，最上方會先顯示當前月份，使用者可點擊月份來切換他想要檢視的月份，在當前月份的旁邊也會顯示該月份目前的結餘狀況

底下會將所選月份的所有記錄按照日期群組，並以日期遞減排序顯示，每個日期群組內則是按照新增時間遞增排序

每個日期群組除了會顯示日期以及當天為星期幾外，也會顯示當天的結餘狀況，每一項記錄則會顯示類型的Icon、項目名稱以及收入、支出金額

#### 欄位說明

(Figma截圖)

| 欄位   | 預設值  | 提示       | 備註                                 |
|------|------|----------|------------------------------------|
| 月份   | 當前月份 |          |                                    |
| 月結餘  |      |          | 無論是收入或支出，皆不顯示正負符號，且文字顏色需符合收入、支出的顏色 |
| +    |      | 新增記錄     |                                    |
| 日期   |      |          | 以"yyyy/MM/dd EEE"格式顯示              |
| 日結餘  |      |          | 無論是收入或支出，皆不顯示正負符號，且文字顏色需符合收入、支出的顏色 |
| 類型   |      | (顯示類型名稱) | 顯示Icon，顏色需符合收入、支出的顏色               |
| 項目名稱 |      |          |                                    |
| 金額   |      |          | 無論是收入或支出，皆不顯示正負符號，且文字顏色需符合收入、支出的顏色 |

#### 排序

先以日期遞減排序，再以新增時間遞增排序

#### 事件流程

| 事件                 | 反應                                              |
|--------------------|-------------------------------------------------|
| 頁面顯示時              | 將當前月份的記帳記錄查出                                    |
| 點擊月份               | 顯示月份選擇的Dialog，點擊Dialog的"確定"後，更新月份、月結餘以及清單顯示的資料  |
| 點擊 +               | 顯示新增記錄畫面                                        |
| 點擊記帳記錄列            | 顯示編輯紀錄畫面                                        |
| 長按記帳記錄列            | 顯示Context Menu，包含一個"刪除"選項，點擊"刪除"後，顯示刪除的確認Dialog |
| 點擊手機自帶的返回按鈕或自帶的上一頁 | 顯示提示訊息："再一次離開應用程式"，在五秒內再次執行此事件，則將應用程式關閉         |

### 新增記錄

#### 欄位說明

(Figma截圖)

| 欄位   | 預設值  | 提示 | 限制          | 預計實現版本 | 備註                                       |
|------|------|----|-------------|--------|------------------------------------------|
| 日期   | 當天   |    | 必填          |        | 以"yyyy/MM/dd EEE"格式顯示，不可手動輸入文字           |
| 分類   |      |    | 必填          |        |                                          |
| 錢包   | 預設錢包 |    | 必填          | v1.1   | 以下拉選單的形式將所有錢包列出，先顯示預設錢包，其餘錢包按照名稱遞增排序放在後面 |
| 錢包餘額 |      |    |             | v1.1   |                                          |
| 項目名稱 |      |    | 必填，最多20個全形字 |        |                                          |
| 金額   |      |    | 必填，必須大於等於0  |        | 有商品細項時，此欄位唯讀                             |
| 商品細項 |      |    |             | v1.2   |                                          |
| 備註   |      |    | 最多1000個全形字  |        |                                          |

#### 排序

錢包的下拉選單需先顯示預設錢包，接著才以名稱排序剩下的錢包

#### 事件流程

| 事件              | 反應                                                          |
|-----------------|-------------------------------------------------------------|
| 點擊日期欄位          | 顯示日期選擇器，預設為今天                                               |
| 點擊分類欄位          | 顯示分類選擇器，預設為支出分類的第一個類型                                       |
| 選擇錢包            | 將餘額顯示至錢包餘額欄位內                                               |
| Focus項目名稱欄位     | 確認是否已選擇分類，若已選擇，則將該類型的所有記帳記錄以下拉選單形式展開，以新增順序遞減排序，相同項目名稱不會重複列出 |
| Focus金額欄位       | 將輸入框內的千分位移除                                                 |
| 取消Focus金額欄位     | 輸入框內加上千分位顯示                                                 |
| 選擇項目名稱下拉選單的任意項目 | 將最新的記帳記錄資料填入底下的欄位，若有任意欄位已有值，則需顯示提示視窗詢問使用者是否確定覆蓋             |
| 點擊商品細項按鈕        | 顯示商品細項頁面                                                    |

### 選擇分類

可供使用者選擇收入、支出兩種主要分類下的類型，點擊任意類型後，可透過確認按鈕將所選類型帶到前一個畫面

#### 欄位說明

(Figma截圖)

| 欄位   | 預設值 | 提示 | 限制 | 預計實現版本 | 備註              |
|------|-----|----|----|--------|-----------------|
| 類型名稱 |     |    |    |        |                 |
| 返回   |     | 返回 |    |        |                 |
| 確認   |     | 確認 |    |        | 在沒有選擇類型時Disable |

#### 事件流程

| 事件     | 反應              |
|--------|-----------------|
| 頁面顯示時  | 將先前選擇的類型選取起來    |
| 點擊返回按鈕 | 回到前一個畫面，不更動分類欄位 |
| 點擊確認按鈕 | 將選擇的類型帶到分類欄位    |

### 商品細項

> 預計實現版本：v1.2

可供使用者新增一條一條的商品細項，並且自動將金額加總後填到記帳記錄的金額欄位

#### 欄位說明

(Figma截圖)

| 欄位   | 預設值 | 提示 | 限制 | 預計實現版本            | 備註             |
|------|-----|----|----|-------------------|----------------|
| 編號   |     |    |    |                   | 第一筆固定為1，往後依序編號 |
| 商品名稱 |     |    |    | 必填，最多15個全形字       |                |
| 單價   |     |    |    | 必填，需大於等於0，小數點最多兩位 |                |
| 數量   | 1   |    |    | 必填，需大於0，小數點最多兩位   |                |
| 總額   | 0   |    |    |                   | 唯讀             |
| 移動   |     |    |    |                   |                |
| 刪除   |     | 刪除 |    |                   |                |
| 返回   |     | 返回 |    |                   |                |
| 確認   |     | 確認 |    |                   |                |

#### 事件流程

| 事件             | 反應                |
|----------------|-------------------|
| 頁面顯示時          | 將先前設定的結果查出並顯示     |
| 輸入單價、數量後       | 自動計算總額，並將結果填到總額欄位 |
| Focus單價、數量欄位   | 將輸入框的內容的千分位移除     |
| 取消Focus單價、數量欄位 | 將輸入的內容加上千分位顯示     |
| 長按移動按鈕並拖曳      | 調整商品細項順序          |
| 點擊刪除按鈕         | 顯示確認Dialog        |
| 點擊返回按鈕         | 回到前一個畫面，不更動金額欄位   |
| 點擊確認按鈕         | 更新金額欄位            |

### 刪除商品細項的確認Dialog

(Figma截圖)

此為避免使用者誤觸刪除，因此在點擊刪除後需顯示此Dialog供使用者確認，*號處需自動帶入商品名稱

### 編輯記錄

同新增記錄，只是這裡會自動代入欲編輯的記帳記錄資料

#### 事件流程

| 事件  | 反應                           |
|-----|------------------------------|
| 點擊v | 儲存異動，並返回記帳記錄畫面，顯示"儲存成功"的提示訊息 |

### 刪除記帳記錄的確認Dialog

(Figma截圖)

此為避免使用者誤觸刪除，因此在點擊刪除後需顯示此Dialog供使用者確認，*號處需以"日期-項目名稱"的格式自動帶入日期以及項目名稱

#### 事件流程

| 事件   | 反應                                        |
|------|-------------------------------------------|
| 點擊確認 | 刪除選定資料，並在成功時顯示"刪除成功"；失敗時以另外一個Dialog顯示錯誤訊息 |
| 點擊取消 | 關閉Dialog                                  |

## 相關功能

[上一篇 - 系統設計](0-系統設計.md) | [下一篇 - 錢包](2-錢包.md)

## 異動紀錄

* 2025/04/25 初版
